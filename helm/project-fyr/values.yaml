# Docker image configuration
image:
  repository: your-registry.example.com/project-fyr
  tag: latest
  pullPolicy: IfNotPresent

watcher:
  replicaCount: 1
  command:
    - python
    - -m
    - project_fyr.service
  args: []
  resources: {}
  nodeSelector: {}
  tolerations: []
  affinity: {}

analyzer:
  replicaCount: 1
  command:
    - python
    - -m
    - project_fyr.analyzer_service
  args: []
  resources: {}
  nodeSelector: {}
  tolerations: []
  affinity: {}

dashboard:
  replicaCount: 1
  command:
    - uvicorn
    - project_fyr.dashboard:app
    - --host
    - 0.0.0.0
    - --port
    - "8000"
  service:
    type: ClusterIP
    port: 80
  ingress:
    enabled: false
    className: ""
    annotations: {}
      # kubernetes.io/ingress.class: nginx
      # cert-manager.io/cluster-issuer: letsencrypt-prod
      # nginx.ingress.kubernetes.io/rewrite-target: /
    hosts:
      - host: fyr.example.com
        paths:
          - path: /
            pathType: Prefix
    tls: []
    #  - secretName: fyr-dashboard-tls
    #    hosts:
    #      - fyr.example.com
  resources: {}
  nodeSelector: {}
  tolerations: []
  affinity: {}

metrics:
  # Prometheus metrics configuration
  serviceMonitor:
    # Enable ServiceMonitor for Prometheus Operator
    enabled: false
    # Namespace where ServiceMonitor should be created (defaults to release namespace)
    namespace: ""
    # Additional labels for ServiceMonitor (useful for Prometheus operator label selectors)
    additionalLabels: {}
      # prometheus: kube-prometheus
    # Scrape interval (default: 30s)
    interval: 30s
    # Scrape timeout (default: 10s)
    scrapeTimeout: 10s
    # Namespace selector for discovering endpoints
    namespaceSelector: {}
    # Relabeling configs to apply to samples before ingestion
    relabelings: []
    # MetricRelabelConfigs to apply to samples before ingestion
    metricRelabelings: []

serviceAccount:
  create: true
  name: ""

rbac:
  create: true

# Application configuration
config:
  # Database connection string (SQLite for development, MySQL/PostgreSQL for production)
  databaseUrl: sqlite:////data/project_fyr.db
  # Name of your Kubernetes cluster (shown in Slack notifications)
  clusterName: my-cluster
  # Timeout in seconds before marking a rollout as failed
  rolloutTimeoutSeconds: 900
  # Slack bot token (xoxb-...) - recommend using existingSecret instead
  slackBotToken: ""
  # Default Slack channel for notifications (e.g., #deployments)
  slackDefaultChannel: "#alerts"
  # Optional: Override Slack API URL (useful for testing with mock service)
  slackApiUrl: ""
  # OpenAI API key - recommend using existingSecret instead
  openaiApiKey: ""
  # OpenAI API base URL (for Azure OpenAI, set to https://your-resource.openai.azure.com)
  openaiApiBase: ""
  # Azure OpenAI API version (e.g., 2024-02-15-preview)
  openaiApiVersion: ""
  # Azure OpenAI deployment name
  azureDeployment: ""
  # LangChain model name (e.g., gpt-4o-mini, gpt-4-turbo-preview)
  langchainModelName: gpt-4o-mini
  # Prometheus URL for metrics queries (optional)
  prometheusUrl: ""

secrets:
  # Name of an existing Secret created by External Secret Operator that contains
  # any PROJECT_FYR_* keys (e.g., Slack tokens, OpenAI API keys, DB credentials).
  existingSecret: ""

mysql:
  enabled: false
  architecture: standalone
  auth:
    rootPassword: ""
    username: projectfyr
    password: projectfyr
    database: projectfyr
  primary:
    persistence:
      enabled: false

# Slack Mock (for development/testing)
# Provides a mock Slack API endpoint to test notifications without real Slack
slackMock:
  enabled: false
  replicaCount: 1
  image:
    repository: python
    tag: "3.12-slim"
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    port: 8080
  resources:
    limits:
      cpu: 100m
      memory: 128Mi
    requests:
      cpu: 50m
      memory: 64Mi
  nodeSelector: {}
  tolerations: []
  affinity: {}
